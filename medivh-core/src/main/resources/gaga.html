<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Method Statistic</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .table-container {
            margin: 50px auto;
            max-width: 80%;
        }
        .table th {
            cursor: pointer;
        }
        .table th.sort-asc::after {
            content: " ▲";
        }
        .table th.sort-desc::after {
            content: " ▼";
        }
        .pagination {
            justify-content: center;
        }
        .page-summary {
            text-align: center;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

<div class="container table-container">
    <h2 class="text-center">Method Statistics</h2>
    <table class="table table-hover table-bordered text-center">
        <thead class="table-dark">
            <tr>
                <th scope="col" data-sort="method">Method</th>
                <th scope="col" data-sort="invokeCount">Invoke Count</th>
                <th scope="col" data-sort="totalCost">Total Cost</th>
                <th scope="col" data-sort="maxCost">Max Cost</th>
                <th scope="col" data-sort="minCost">Min Cost</th>
                <th scope="col" data-sort="avgCost">Avg Cost</th>
            </tr>
        </thead>
        <tbody id="table-body">
            <!-- Table rows will be dynamically populated here -->
        </tbody>
    </table>

    <!-- Pagination Controls -->
    <nav aria-label="Page navigation">
        <ul class="pagination">
            <!-- Pagination items will be dynamically populated here -->
        </ul>
    </nav>

    <div class="page-summary">
        Showing <span id="start-row"></span> to <span id="end-row"></span> of <span id="total-rows"></span> entries
    </div>
</div>

<script>
    const data = [
        { method: 'methodA', invokeCount: 100, totalCost: 2000, maxCost: 50, minCost: 10 },
        { method: 'methodB', invokeCount: 150, totalCost: 3000, maxCost: 60, minCost: 20 },
        { method: 'methodC', invokeCount: 200, totalCost: 5000, maxCost: 70, minCost: 30 },
        { method: 'methodD', invokeCount: 80, totalCost: 1600, maxCost: 45, minCost: 15 },
        { method: 'methodE', invokeCount: 120, totalCost: 2400, maxCost: 55, minCost: 18 },
        { method: 'methodF', invokeCount: 180, totalCost: 4000, maxCost: 65, minCost: 22 },
        { method: 'methodG', invokeCount: 140, totalCost: 3200, maxCost: 52, minCost: 16 },
        { method: 'methodH', invokeCount: 170, totalCost: 3800, maxCost: 62, minCost: 25 },
        { method: 'methodI', invokeCount: 220, totalCost: 5500, maxCost: 75, minCost: 28 },
        { method: 'methodJ', invokeCount: 90, totalCost: 1800, maxCost: 40, minCost: 14 },
        { method: 'methodK', invokeCount: 130, totalCost: 2600, maxCost: 58, minCost: 20 },
    ];

    const rowsPerPage = 5;
    let currentPage = 1;
    let sortColumn = '';
    let sortDirection = 'asc';

    data.forEach(item => {
        item.avgCost = Math.floor(item.totalCost / item.invokeCount);
    });

    function renderTable() {
        const tbody = document.getElementById('table-body');
        tbody.innerHTML = '';

        const sortedData = [...data].sort((a, b) => {
            if (sortColumn) {
                const aVal = a[sortColumn];
                const bVal = b[sortColumn];
                return sortDirection === 'asc' ? aVal - bVal : bVal - aVal;
            }
            return 0;
        });

        const start = (currentPage - 1) * rowsPerPage;
        const paginatedData = sortedData.slice(start, start + rowsPerPage);

        paginatedData.forEach(item => {
            const row = `<tr>
                <td>${item.method}</td>
                <td>${item.invokeCount}</td>
                <td>${item.totalCost}</td>
                <td>${item.maxCost}</td>
                <td>${item.minCost}</td>
                <td>${item.avgCost}</td>
            </tr>`;
            tbody.insertAdjacentHTML('beforeend', row);
        });

        document.getElementById('start-row').textContent = start + 1;
        document.getElementById('end-row').textContent = start + paginatedData.length;
        document.getElementById('total-rows').textContent = data.length;

        document.querySelectorAll('th').forEach(th => {
            th.classList.remove('sort-asc', 'sort-desc');
        });
        if (sortColumn) {
            const th = document.querySelector(`th[data-sort="${sortColumn}"]`);
            th.classList.add(sortDirection === 'asc' ? 'sort-asc' : 'sort-desc');
        }
    }

    function renderPagination() {
        const totalPages = Math.ceil(data.length / rowsPerPage);
        const pagination = document.querySelector('.pagination');
        pagination.innerHTML = '';

        const prevDisabled = currentPage === 1 ? 'disabled' : '';
        pagination.insertAdjacentHTML('beforeend', `
            <li class="page-item ${prevDisabled}">
                <a class="page-link" href="#" aria-label="Previous">&laquo;</a>
            </li>
        `);

        const maxPagesToShow = 5;
        const startPage = Math.max(1, currentPage - Math.floor(maxPagesToShow / 2));
        const endPage = Math.min(totalPages, startPage + maxPagesToShow - 1);

        if (startPage > 1) {
            pagination.insertAdjacentHTML('beforeend', `<li class="page-item"><a class="page-link" href="#">1</a></li>`);
            if (startPage > 2) {
                pagination.insertAdjacentHTML('beforeend', `<li class="page-item disabled"><span class="page-link">...</span></li>`);
            }
        }

        for (let i = startPage; i <= endPage; i++) {
            const active = i === currentPage ? 'active' : '';
            pagination.insertAdjacentHTML('beforeend', `
                <li class="page-item ${active}">
                    <a class="page-link" href="#">${i}</a>
                </li>
            `);
        }

        if (endPage < totalPages) {
            if (endPage < totalPages - 1) {
                pagination.insertAdjacentHTML('beforeend', `<li class="page-item disabled"><span class="page-link">...</span></li>`);
            }
            pagination.insertAdjacentHTML('beforeend', `<li class="page-item"><a class="page-link" href="#">${totalPages}</a></li>`);
        }

        const nextDisabled = currentPage === totalPages ? 'disabled' : '';
        pagination.insertAdjacentHTML('beforeend', `
            <li class="page-item ${nextDisabled}">
                <a class="page-link" href="#" aria-label="Next">&raquo;</a>
            </li>
        `);

        document.querySelectorAll('.page-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const text = e.target.textContent;
                if (text === '«') {
                    currentPage = Math.max(1, currentPage - 1);
                } else if (text === '»') {
                    currentPage = Math.min(totalPages, currentPage + 1);
                } else {
                    currentPage = parseInt(text);
                }
                renderTable();
                renderPagination();
            });
        });
    }

    document.querySelectorAll('th[data-sort]').forEach(header => {
        header.addEventListener('click', () => {
            const column = header.getAttribute('data-sort');
            if (sortColumn === column) {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                sortColumn = column;
                sortDirection = 'asc';
            }
            renderTable();
        });
    });

    renderTable();
    renderPagination();
</script>

</body>
</html>
